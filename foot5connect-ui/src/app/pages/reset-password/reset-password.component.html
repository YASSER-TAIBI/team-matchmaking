<div class="login-page">
  <div class="login-page__bg"></div>

  <div class="login-split">
    <div class="login-split__left">
      <div class="auth-card">
        <div class="auth-surface">
          <div class="brand">
            <div class="brand__logo" aria-hidden="true">
              <mat-icon class="brand__logo-icon">sports_soccer</mat-icon>
            </div>
            <div class="brand__name">PitchPerfect</div>
          </div>

          <div class="hero">
            <h1 class="title">Nouveau <strong style="color: #35ff7a;">mot de passe</strong></h1>
            <p class="subtitle">
              Choisis un nouveau mot de passe.
            </p>
          </div>

          @if(isCheckingToken) {
            <div class="info-block">Vérification du token...</div>
          }

          @if(!isCheckingToken && !isTokenValid) {
            <div class="error-block">
              <ul>
                @for(error of errorMessage; track $index) {
                  <li>{{ error }}</li>
                }
              </ul>
            </div>

            <button mat-stroked-button class="provider" type="button" (click)="backToLogin()">
              <mat-icon>arrow_back</mat-icon>
              <span>Retour login</span>
            </button>
          }

          @if(!isCheckingToken && isTokenValid) {
            <form class="auth-form">
              <div class="field-block">
                <div class="label">Mot de passe</div>
                <mat-form-field class="field" appearance="outline">
                  <mat-icon matPrefix>lock_outline</mat-icon>
                  <input matInput type="password" placeholder="••••••••" [(ngModel)]="password" name="password" required/>
                </mat-form-field>
              </div>

              <div class="field-block">
                <div class="label">Confirmer mot de passe</div>
                <mat-form-field class="field" appearance="outline">
                  <mat-icon matPrefix>lock_outline</mat-icon>
                  <input matInput type="password" placeholder="••••••••" [(ngModel)]="confirmPassword" name="confirmPassword" required/>
                </mat-form-field>
              </div>

              <button mat-flat-button class="primary" type="button" [disabled]="isSubmitting" (click)="submit()">
                <span>Mettre à jour</span>
                <mat-icon>arrow_forward</mat-icon>
              </button>

              @if(infoMessage) {
                <div class="info-block">{{ infoMessage }}</div>
              }

              @if(errorMessage.length) {
                <div class="error-block">
                  <ul>
                    @for(error of errorMessage; track $index) {
                      <li>{{ error }}</li>
                    }
                  </ul>
                </div>
              }

              <div class="divider">
                <mat-divider></mat-divider>
                <span class="divider__label">OU</span>
                <mat-divider></mat-divider>
              </div>

              <button mat-stroked-button class="provider" type="button" (click)="backToLogin()">
                <mat-icon>arrow_back</mat-icon>
                <span>Retour login</span>
              </button>
            </form>
          }

        </div>
      </div>
    </div>
  </div>
</div>
